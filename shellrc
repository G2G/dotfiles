# Add the Ruby bin to the path.
if [ -d ~/.gem/ruby/1.9.1/bin ]; then
    export PATH=~/.gem/ruby/1.9.1/bin:$PATH
fi

# Add ~/bin to the beginning of the path.
if [ -d ~/bin ]; then
    export PATH=~/bin:$PATH
fi

# Set vim as the default editor.
export EDITOR='vim'

# Set the Python version for virtualenvwrapper to use on WebFaction.
if [[ `hostname` =~ webfaction  ]] ; then
    export VIRTUALENVWRAPPER_PYTHON=/usr/local/bin/python2.7
fi

# Install virtualenvwrapper, wherever it may be!
if [ -f $HOME/bin/virtualenvwrapper.sh ]; then
        export WORKON_HOME=$HOME/.virtualenvs
        source $HOME/bin/virtualenvwrapper.sh
elif [ -f /usr/local/bin/virtualenvwrapper.sh ]; then
        export WORKON_HOME=$HOME/.virtualenvs
        source /usr/local/bin/virtualenvwrapper.sh
elif [ -f /usr/bin/virtualenvwrapper.sh ]; then
        export WORKON_HOME=$HOME/.virtualenvs
        source /usr/bin/virtualenvwrapper.sh
fi

# Set GPG_TTY for gpg-agent.
export GPG_TTY=`tty`

# Set todo.txt to list tasks by default
export TODOTXT_DEFAULT_ACTION=ls

# Load shell aliases.
if [ -f ~/.aliases ]; then
    source ~/.aliases
fi

#########
# Notes #
#########

# Set the note directory.
NOTEDIR=~/documents/notes

# Create or edit notes.
n() {
    if [ -z "$1" ]; then
        lt "$NOTEDIR"
    else
        # Build the full path of the note.
        note="$NOTEDIR"/"$1"

        # If an extension was given, use it.
        if [[ "$1" == *.* ]]; then
            vim "$note"

        # If no extension was given...
        else
            # ... try the file without any extension.
            if [ -e "$note" ]; then
                vim "$note"
            # ... try the file with a gpg extension.
            elif [ -e "$note".gpg ]; then
                vim "$note".gpg
            # ... use a txt extension.
            else
                vim "$note".txt
            fi
        fi
    fi
}

# Find a note by title.
nf() {
    if [ -z "$1" ]; then
        lt "$NOTEDIR"
    else
        lt "$NOTEDIR" | grep -i $1
    fi
}

# Search within notes.
ns() { cd $NOTEDIR; grep -rin $1; cd "$OLDPWD"; }
